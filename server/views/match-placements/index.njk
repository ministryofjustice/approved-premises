{% extends "../partials/layout.njk" %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}

{% set pageTitle = applicationName + " - Find a placement (Matching algorithm)" %}

{% block content %}

  <main class="app-container govuk-body">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-full">
        <h1>Find a placement (Matching algorithm)</h1>
        <form method="post" action="/match-placements">
          <input type="hidden" name="_csrf" value={{csrfToken}}>
          {{ govukInput({
            label: {
              text: "What is the target location for this person?"
            },
            classes: "govuk-input--width-20",
            hint: {
                text: "Enter a place name or postcode"
              },
            id: "placement_search[location]",
            name: "placement_search[location]"
          }) }}

          {{ govukCheckboxes({
            idPrefix: "placement_search[location]",
            name: "placement_search[requirements][]",
            fieldset: {
              legend: {
                text: "Requirements"
              }
            },
            hint: {
              text: "Select all that apply."
            },
            items: [
              {
                value: "bed.enhanced_security",
                text: "Enhanced security",
                checked: (filterArgs.requirements|length and 'bed.enhanced_security' in filterArgs.requirements)
              },
              {
                value: "bed.step_free_access_to_communal_areas",
                text: "Step free access to communal areas",
                checked: (filterArgs.requirements|length and 'bed.step_free_access_to_communal_areas' in filterArgs.requirements)
              },
              {
                value: "bed.lift_or_stairlift",
                text: "Lift or Stairlift Available",
                checked: (filterArgs.requirements|length and 'bed.lift_or_stairlift' in filterArgs.requirements)
              }
            ]
          }) }}

          {{ govukButton({
            text: "Find matching AP placements"
          }) }}
        </form>

        {{ govukTable({
              captionClasses: "govuk-table__caption--l",
              firstCellIsHeader: true,
              head: [
                {
                  text: "AP Code"
                },
                {
                  text: "Name"
                },
                {
                  text: "Town"
                },
                {
                  text: "Distance"
                },
                {
                  text: "Enhanced security?"
                },
                {
                  text: "Step free access to communal areas?"
                },
                {
                  text: "Lift or Stairlift Available?"
                },
                {
                  text: "Score"
                }
              ],
              rows: apRows
            }) }}

      </div>
    </div>
  </main>

{% endblock %}


